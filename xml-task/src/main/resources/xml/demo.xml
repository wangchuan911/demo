<?xml version="1.0" encoding="UTF-8"?>
<task>
    <initialization>
        <instance id="ftp1" tag="ftp"/>
        <instance id="csv1" tag="csv"/>
        <instance id="http1" tag="http"/>
        <database id="rimdb" model="oracle"></database>
        <value id="val1"></value>
        <value id="val2"></value>
    </initialization>
    <start>
        <transactional link="rimdb" batch="50">
            <http>
                <body>asdasdasdsadasdasdasdasdas</body>
            </http>
            <select id="select1" link="rimdb">
                <sql>
                    select 1 as "val" from dual union select 2 from dual
                    where
                    <if test="$inputs.input1=='123'">
                        1=1 and
                    </if>

                    1=1
                </sql>
                <iterator>
                    <if test="select1.item.val==2 ">
                        <http url="">
                            <body>
                                {"name":"{{$inputs.input1}}","name2":"{{$inputs.input2}}","name3":"{{$inputs.input3}}"}

                            </body>
                        </http>
                        <insert>
                            insert into pub_scan_log(id,res_id)
                            values(seq_pub_scan_log.nextval,#{select1.item.val,jdbcType=VARCHAR})
                        </insert>
                        <ftp ref="ftp1"></ftp>
                    </if>
                </iterator>
            </select>
        </transactional>
    </start>
</task>